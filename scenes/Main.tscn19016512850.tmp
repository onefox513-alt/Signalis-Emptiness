[gd_scene format=3 uid="uid://mjatljagf266"]

[ext_resource type="Script" uid="uid://dnm2tcklp2buf" path="res://scripts/GameManager.gd" id="1_rarhs"]
[ext_resource type="PackedScene" uid="uid://8am0ijcmolnm" path="res://scenes/lower_obstacle.tscn" id="2_vcsgt"]
[ext_resource type="PackedScene" uid="uid://05fqjeh7ny0e" path="res://scenes/standart_obstacle.tscn" id="3_c01mt"]
[ext_resource type="Script" uid="uid://b876qh0q75ddm" path="res://scripts/player.gd" id="4_nxtc6"]
[ext_resource type="PackedScene" uid="uid://d01tr2clee3l1" path="res://scenes/upper_obstacle.tscn" id="4_vcsgt"]
[ext_resource type="PackedScene" uid="uid://4hlne0sr4xtf" path="res://scenes/coin.tscn" id="5_nxtc6"]
[ext_resource type="Script" uid="uid://bglfb8klkjys7" path="res://scripts/ui_manager.gd" id="6_c01mt"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_glms7"]
sky_top_color = Color(0.2808955, 0.3981322, 0.86358666, 1)
sky_horizon_color = Color(0.60334635, 0.62490547, 0.7322691, 1)
ground_horizon_color = Color(0.60334635, 0.62490547, 0.7322691, 1)

[sub_resource type="Sky" id="Sky_udu3i"]
sky_material = SubResource("ProceduralSkyMaterial_glms7")

[sub_resource type="Environment" id="Environment_oo155"]
background_mode = 2
sky = SubResource("Sky_udu3i")
tonemap_mode = 2
ssao_enabled = true
sdfgi_enabled = true
glow_enabled = true

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_udu3i"]
radius = 0.4038086
height = 2.0720215

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_rarhs"]
radius = 0.3612976
height = 0.7225952

[sub_resource type="CylinderMesh" id="CylinderMesh_oo155"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_hwd4i"]
albedo_color = Color(0.8039216, 0.10980392, 0.0627451, 1)

[sub_resource type="SphereMesh" id="SphereMesh_eaq8r"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_jlsqs"]
radius = 0.453125
height = 2.190796

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_udu3i"]

[node name="Game Manager" type="Node3D" unique_id=10936960]
script = ExtResource("1_rarhs")
ObstacleScene = Array[PackedScene]([ExtResource("2_vcsgt"), ExtResource("3_c01mt"), ExtResource("4_vcsgt")])
PowerupsScene = Array[PackedScene]([ExtResource("5_nxtc6")])
MinSpawnTime = null
MaxSpawnTime = null
SpawnDistance = -30.0
PickubleSpawnChance = null

[node name="WorldEnvironment" type="WorldEnvironment" parent="." unique_id=1367760503]
environment = SubResource("Environment_oo155")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="." unique_id=542100335]
transform = Transform3D(-0.994338, -0.042882342, 0.097227275, 0, 0.91495967, 0.40354532, -0.106264, 0.40126044, -0.90977913, 0, 0, 0)
light_color = Color(0.9999997, 0.9883755, 0.98636657, 1)
light_energy = 0.45
shadow_enabled = true
directional_shadow_max_distance = 335.0

[node name="Player" type="CharacterBody3D" parent="." unique_id=754409106]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.0723938, 0)
script = ExtResource("4_nxtc6")

[node name="StandingCollision" type="CollisionShape3D" parent="Player" unique_id=1001094058]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.33776855, 0)
shape = SubResource("CapsuleShape3D_udu3i")

[node name="CrouchedCollision" type="CollisionShape3D" parent="Player" unique_id=2006460093]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.3603977, 0)
shape = SubResource("CapsuleShape3D_rarhs")

[node name="Model" type="Node3D" parent="Player" unique_id=331026574]

[node name="MeshInstance3D" type="MeshInstance3D" parent="Player/Model" unique_id=296897249]
transform = Transform3D(0.8, 0, 0, 0, 0.8034386, 0, 0, 0, 0.8, 0, 0.05330968, 0)
mesh = SubResource("CylinderMesh_oo155")
surface_material_override/0 = SubResource("StandardMaterial3D_hwd4i")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Player/Model" unique_id=391440424]
transform = Transform3D(0.88000005, 0, 0, 0, 0.77, 0, 0, 0, 0.8465012, 0, 1, -0.0067148805)
mesh = SubResource("SphereMesh_eaq8r")

[node name="Camera3D" type="Camera3D" parent="Player" unique_id=247418771]
transform = Transform3D(1, 0, 0, 0, 0.9659258, 0.25881904, 0, -0.25881904, 0.9659258, 0, 2, 3)
fov = 90.0

[node name="RayCast3D" type="RayCast3D" parent="Player" unique_id=461089778]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.7091654, 0)
target_position = Vector3(0, -0.3, 0)

[node name="PowerupCollider" type="Area3D" parent="Player" unique_id=1275122686]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player/PowerupCollider" unique_id=710511117]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.28399658, 0)
shape = SubResource("CapsuleShape3D_jlsqs")

[node name="Enviroment" type="Node3D" parent="." unique_id=285114759]

[node name="StaticBody3D" type="StaticBody3D" parent="Enviroment" unique_id=916747796]

[node name="CSGBox3D" type="CSGBox3D" parent="Enviroment/StaticBody3D" unique_id=1217953875]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -87.833694)
use_collision = true
size = Vector3(10, 0.5, 200)
material = SubResource("StandardMaterial3D_udu3i")

[node name="ObstacleContainer" type="Node3D" parent="." unique_id=408069505]

[node name="SpawnTimer" type="Timer" parent="." unique_id=763384283]
autostart = true

[node name="ScoreTimer" type="Timer" parent="." unique_id=1836881947]
autostart = true

[node name="UI Manager" type="Control" parent="." unique_id=2062154514]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("6_c01mt")

[node name="RichTextLabel" type="RichTextLabel" parent="UI Manager" unique_id=646457223]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -154.0
offset_bottom = 58.0
grow_horizontal = 0
text = "Score"

[connection signal="ScoreUpdated" from="." to="UI Manager" method="_on_game_manager_score_updated"]
[connection signal="AddScore" from="Player" to="." method="_on_player_add_score"]
[connection signal="area_entered" from="Player/PowerupCollider" to="Player" method="_on_powerup_collider_area_entered"]
[connection signal="timeout" from="SpawnTimer" to="." method="_on_spawn_timer_timeout"]
[connection signal="timeout" from="ScoreTimer" to="." method="_on_score_timer_timeout"]
